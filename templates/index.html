{% extends 'base.html' %}
{% load static %}
{% block content %}
<h1>{{ title }}</h1>
{% if request.session.user_given_name %}
<p class="text-secondary">Logged in as: {{ request.session.user_given_name }}</p>
{% endif %}
{% if request.session.is_logged_in and not request.session.institution_for_login_session %}
<div class="row">
    <div class="col-lg-8">
        {% if not request.session.user_institution_subgroups %}
        <div class="alert alert-light">
            <h2>Register or Join an Institution</h2>
            <p>
                To enable scientific metadata management capabilities,
                please join or register for a new institution using the
                links below.
            </p>
            <ul>
                <li>
                    <a href="{{ create_institution_url }}">
                        Register a New Institution
                    </a>
                </li>
                <li>
                    <a href="{% url 'list_joinable_perun_organisations' %}">
                        Join an Existing Institution
                    </a>
                </li>
            </ul>
        </div>
        {% else %}
        <div class="alert alert-primary">
            <p>
                To enable scientific metadata management capabilities,
                please select the institution you would like to act on
                behalf of for this login session.
            </p>
            <form action="{% url 'set_institution_for_login_session' %}" method="POST">
                {% csrf_token %}
                {{ request.institution_selection_form }}
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
        {% endif %}
    </div>
</div>
<hr>
{% endif %}
<section>
    <h2 class="mb-3">Scientific Metadata</h2>
    <div class="card-menu mb-2">
        <div class="card">
            <div class="card-body">
                <a href="{% url 'search:index' %}">
                    <img src="{% static 'search.svg' %}" alt="Search">
                    <span>Search Data Collections with Ontology</span>
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <a href="{% url 'browse:list_data_collections' %}">
                    <img src="{% static 'browse.svg' %}" alt="Browse">
                    <span>Browse Data Collections</span>
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <a href="{% url 'browse:catalogue_related_resource_types' %}">
                    <img src="{% static 'browse.svg' %}" alt="Browse">
                    <span>Browse Catalogues</span>
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <a href="{% url 'browse:index' %}">
                    <img src="{% static 'browse.svg' %}" alt="Browse">
                    <span>Browse All Metadata</span>
                </a>
            </div>
        </div>
    </div>
</section>
<hr>
<section>
    <h2 class="mb-3">Space Physics Ontology</h2>
    <div class="card-menu mb-2">
        <div class="card">
            <div class="card-body">
                <a href="{% url 'ontology:index' %}">
                    <img src="{% static 'ontology.svg' %}" alt="Ontology">
                    <span>Browse Space Physics Ontology</span>
                </a>
            </div>
        </div>
    </div>
</section>
{% if request.session.institution_for_login_session %}
<hr>
<h2>{{ request.session.institution_for_login_session }}</h2>
<section>
    <h3 class="text-secondary mb-3">Scientific Metadata Registrations</h3>
    <div class="card-menu mb-2">
        <div class="card">
            <div class="card-body">
                <a href="{% url 'resource_management:index' %}">
                    <img src="{% static 'file_upload.svg' %}" alt="File Upload">
                    <span>Manage Registrations</span>
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <a href="https://docs.google.com/document/d/1NK-YcZQZZju62_YC7mXFVZrkLFplEYFuaKKSet9uhJY/edit#" target="_blank">
                    <img src="{% static 'file_info.svg' %}" alt="Info">
                    <span>View Metadata Registration Guide</span>
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <a href="{% url 'schemas' %}">
                    <img src="{% static 'data_models.svg' %}" alt="Data Models">
                    <span>View Metadata Models</span>
                </a>
            </div>
        </div>
    </div>
</section>
{% if 'admins' in request.session.subgroup_for_login_session %}
<section>
    <h3 class="text-secondary mb-3">Memberships</h3>
    <div class="card-menu mb-2">
        <div class="card">
            <div class="card-body">
                <a href="#">
                    <img src="{% static 'data_models.svg' %}" alt="Data Models">
                    Manage Members
                </a>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endif %}
{% if request.session.is_logged_in and request.session.institution_for_login_session %}
<hr>
<section>
    <h2 class="mb-3">My Institutions</h2>
    <div class="card-menu mb-2">
        <div class="card">
            <div class="card-body">
                <a href="{{ create_institution_url }}">
                    <img src="{% static 'data_models.svg' %}" alt="Data Models">
                    Register a New Institution
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body">
                <a href="{% url 'list_joinable_perun_organisations' %}">
                    <img src="{% static 'data_models.svg' %}" alt="Data Models">
                    Join Another Institution
                </a>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock content %}
