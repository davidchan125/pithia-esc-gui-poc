{% extends 'browse/detail.html' %}
{% load project_tags %}
{% block interaction_methods %}
{% if api_interaction_methods %}
<section class="resource-detail-section">
    <h2>Execute from e-Science Centre</h2>
    <ul class="list-group mt-0">
        {% for method in api_interaction_methods %}
        <li class="list-group-item">
            <div class="d-flex flex-column row-gap-3 py-2">
                <div>
                    <h3 class="fs-5">
                        <a href="{% url 'present:interact_with_data_collection_through_api' data_collection_id %}" class="icon-link icon-link-hover icon-link-interaction-method link-plain-by-default" target="_blank" rel="noopener noreferrer">
                            Interact
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right ms-xl-1 ms-3" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"/>
                            </svg>
                        </a>
                    </h3>
                    <div>
                        <span class="badge rounded-pill text-bg-light">
                            API
                        </span>
                    </div>
                </div>
                {% if 'description' in method.config and method.config.description|length > 0 %}
                <p class="mb-0">
                    {{ method.config.description|urlize }}
                </p>
                {% endif %}
            </div>
        </li>
        {% endfor %}
    </ul>
</section>
{% endif %}
{% if link_interaction_methods %}
<section class="resource-detail-section">
    <h2>Collection Results</h2>
    <ul class="list-group mt-0">
        {% for source in link_interaction_methods %}
        {% with online_resource=source.OnlineResource %}
        <li class="list-group-item py-3">
            <details class="details-interaction-methods" name="details-collection-results">
                <summary class="summary-marker-custom">
                    <h3 class="fs-5">
                        <a href="{{ online_resource.linkage|get_key_value:'gmd:URL' }}" class="link-plain-by-default" target="_blank" rel="noopener noreferrer">
                            {{ online_resource.name }}</a>
                    </h3>
                </summary>
                <div class="d-flex flex-column row-gap-3">
                    {% if 'serviceFunction' in online_resource %}
                    {% with value=online_resource.serviceFunction|get_key_value:'@xlink:href' %}
                    {% include 'browse/placeholders/ontology_server_url_pill_placeholder_no_link.html' %}
                    {% endwith %}
                    {% else %}
                    <span class="badge rounded-pill text-bg-light">
                        Linkage
                    </span>
                    {% endif %}
                    {% if 'description' in online_resource and online_resource.description %}
                    <p class="mb-0">
                        {{ online_resource.description|urlize }}
                    </p>
                    {% endif %}
                    <details>
                        <summary>More details</summary>
                        <dl class="mt-3">
                            <div>
                                <dt>Protocol</dt>
                                <dd>{{ online_resource.protocol }}</dd>
                            </div>
                            <div>
                                <dt>Data Formats</dt>
                                <dd>
                                    <ul style="list-style-type: disc;">
                                        {% for data_format in online_resource.dataFormat %}
                                        <li>
                                            {% with value=data_format|get_key_value:'@xlink:href' %}
                                            {% include 'browse/placeholders/ontology_server_url_placeholder.html' %}
                                            {% endwith %}
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </dd>
                            </div>
                        </dl>
                    </details>
                </div>
            </details>
        </li>
        {% endwith %}
        {% endfor %}
    </ul>
</section>
{% endif %}
{% endblock interaction_methods %}